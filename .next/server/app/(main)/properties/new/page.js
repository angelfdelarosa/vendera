(()=>{var e={};e.id=128,e.ids=[128],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},28357:(e,r,t)=>{Promise.resolve().then(t.bind(t,44386))},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},34729:(e,r,t)=>{"use strict";t.d(r,{T:()=>i});var s=t(60687),a=t(43210),o=t(4780);let i=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("textarea",{className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:t,...r}));i.displayName="Textarea"},41509:(e,r,t)=>{Promise.resolve().then(t.bind(t,87516))},44386:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/(main)/properties/new/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/(main)/properties/new/page.tsx","default")},44493:(e,r,t)=>{"use strict";t.d(r,{BT:()=>d,Wu:()=>p,ZB:()=>l,Zp:()=>i,aR:()=>n,wL:()=>c});var s=t(60687),a=t(43210),o=t(4780);let i=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));i.displayName="Card";let n=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",e),...r}));n.displayName="CardHeader";let l=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));l.displayName="CardTitle";let d=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",e),...r}));d.displayName="CardDescription";let p=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",e),...r}));p.displayName="CardContent";let c=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",e),...r}));c.displayName="CardFooter"},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78148:(e,r,t)=>{"use strict";t.d(r,{b:()=>n});var s=t(43210),a=t(3416),o=t(60687),i=s.forwardRef((e,r)=>(0,o.jsx)(a.sG.label,{...e,ref:r,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));i.displayName="Label";var n=i},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},80013:(e,r,t)=>{"use strict";t.d(r,{J:()=>d});var s=t(60687),a=t(43210),o=t(78148),i=t(24224),n=t(4780);let l=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)(o.b,{ref:t,className:(0,n.cn)(l(),e),...r}));d.displayName=o.b.displayName},81630:e=>{"use strict";e.exports=require("http")},87516:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var s=t(60687),a=t(43210),o=t(16189),i=t(29523),n=t(44493),l=t(89667),d=t(80013),p=t(34729),c=t(15079),u=t(11516),m=t(29867),h=t(60359),x=t(30474),f=t(99182),y=t(18780);function g(){let e=(0,o.useRouter)(),{toast:r}=(0,m.dj)(),t=(0,h.W)(e=>e.addProperty),{t:g}=(0,f.B)(),{user:v,loading:j,supabase:b}=(0,y.A)(),w=()=>({title:"",price:35e5,currency:"USD",location:"Beverly Hills",address:"123 Rodeo Drive, Beverly Hills, CA",propertyType:"villa",numBedrooms:4,numBathrooms:3,area:600,features:"Swimming Pool, Garage, Ocean view",description:""}),[P,N]=(0,a.useState)(!1),[_,C]=(0,a.useState)(w()),[q,R]=(0,a.useState)([]),[B,A]=(0,a.useState)([]),F=e=>{let{id:r,value:t}=e.target;C(e=>({...e,[r]:t}))},k=e=>{let{id:r,value:t}=e.target;C(e=>({...e,[r]:parseInt(t)||0}))},D=(e,r)=>{C(t=>({...t,[e]:r}))},J=async s=>{if(s.preventDefault(),!v)return void r({title:"Authentication Error",description:"You must be logged in to list a property.",variant:"destructive"});N(!0);let a=[];if(q.length>0){let e=q.map(async e=>{let r=e.name.split(".").pop(),t=`${Date.now()}.${r}`,s=`${v.id}/${t}`,{error:a}=await b.storage.from("property_images").upload(s,e);if(a)throw a;let{data:{publicUrl:o}}=b.storage.from("property_images").getPublicUrl(s);return o});try{a=await Promise.all(e)}catch(e){console.error("Error uploading images:",e),r({title:"Image Upload Failed",description:e.message||"An unknown error occurred during image upload.",variant:"destructive"}),N(!1);return}}else a=["https://placehold.co/600x400.png","https://placehold.co/600x400.png"];let o=_.features.split(",").map(e=>e.trim()).filter(Boolean),i={realtor_id:v.id,title:_.title,price:_.price,currency:_.currency,location:_.location,address:_.address,type:_.propertyType,bedrooms:_.numBedrooms,bathrooms:_.numBathrooms,area:_.area,description:_.description,features:o,images:a};console.log("Inserting data:",i);let{data:n,error:l}=await b.from("properties").insert(i).select().single();if(l){console.error("Error inserting property:",l),r({title:"Error Listing Property",description:l.message||"An unknown error occurred.",variant:"destructive"}),N(!1);return}let{data:d}=await b.from("profiles").select("full_name, avatar_url, username").eq("user_id",v.id).single();if(!d){r({title:"Error fetching realtor profile",description:"Could not find realtor data after listing property.",variant:"destructive"}),N(!1);return}let p={...n,realtor:{user_id:v.id,full_name:d?.full_name||"Anonymous",avatar_url:d?.avatar_url||"https://placehold.co/100x100.png",username:d?.username||""}};t(p),r({title:g("newProperty.toast.listed.title"),description:g("newProperty.toast.listed.description")}),C(w()),R([]),A([]),N(!1),e.push(`/properties/${p.id}`)};return j||!v?(0,s.jsxs)("div",{className:"flex justify-center items-center min-h-[calc(100vh-8rem)]",children:[(0,s.jsx)(u.A,{className:"h-16 w-16 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-4",children:"Redirecting to login..."})]}):(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsx)(n.Zp,{className:"max-w-4xl mx-auto",children:(0,s.jsxs)("form",{onSubmit:J,children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{className:"font-headline text-2xl",children:g("newProperty.title")}),(0,s.jsx)(n.BT,{children:g("newProperty.subtitle")})]}),(0,s.jsxs)(n.Wu,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"title",children:g("newProperty.form.name")}),(0,s.jsx)(l.p,{id:"title",placeholder:g("newProperty.form.name_placeholder"),value:_.title,onChange:F,required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"price",children:g("newProperty.form.price")}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.p,{id:"price",type:"number",placeholder:"e.g., 3500000",value:_.price,onChange:k,required:!0,className:"flex-grow"}),(0,s.jsxs)(c.l6,{value:_.currency,onValueChange:e=>D("currency",e),children:[(0,s.jsx)(c.bq,{className:"w-[100px]",children:(0,s.jsx)(c.yv,{})}),(0,s.jsxs)(c.gC,{children:[(0,s.jsx)(c.eb,{value:"USD",children:"USD"}),(0,s.jsx)(c.eb,{value:"DOP",children:"DOP"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"location",children:g("newProperty.form.location")}),(0,s.jsx)(l.p,{id:"location",placeholder:"e.g., Santo Domingo",value:_.location,onChange:F})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"address",children:g("newProperty.form.address")}),(0,s.jsx)(l.p,{id:"address",placeholder:"e.g., Av. Winston Churchill #123",value:_.address,onChange:F})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"property-type",children:g("search.propertyType")}),(0,s.jsxs)(c.l6,{onValueChange:e=>D("propertyType",e),value:_.propertyType,children:[(0,s.jsx)(c.bq,{id:"property-type",children:(0,s.jsx)(c.yv,{placeholder:g("newProperty.form.type_placeholder")})}),(0,s.jsxs)(c.gC,{children:[(0,s.jsx)(c.eb,{value:"house",children:g("property.types.house")}),(0,s.jsx)(c.eb,{value:"apartment",children:g("property.types.apartment")}),(0,s.jsx)(c.eb,{value:"condo",children:g("property.types.condo")}),(0,s.jsx)(c.eb,{value:"villa",children:g("property.types.villa")}),(0,s.jsx)(c.eb,{value:"lot",children:g("property.types.lot")})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"numBedrooms",children:g("newProperty.form.bedrooms")}),(0,s.jsx)(l.p,{id:"numBedrooms",type:"number",placeholder:"e.g., 5",value:_.numBedrooms,onChange:k})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"numBathrooms",children:g("newProperty.form.bathrooms")}),(0,s.jsx)(l.p,{id:"numBathrooms",type:"number",placeholder:"e.g., 6",value:_.numBathrooms,onChange:k})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"area",children:g("newProperty.form.area")}),(0,s.jsx)(l.p,{id:"area",type:"number",placeholder:"e.g., 600",value:_.area,onChange:k})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"features",children:g("newProperty.form.features")}),(0,s.jsx)(l.p,{id:"features",placeholder:g("newProperty.form.features_placeholder"),value:_.features,onChange:F}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:g("newProperty.form.amenities_note")})]}),(0,s.jsxs)("div",{className:"md:col-span-2 space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"description",children:g("property.description")}),(0,s.jsx)(p.T,{id:"description",placeholder:g("newProperty.form.description_placeholder"),className:"min-h-[120px]",value:_.description,onChange:F})]}),(0,s.jsxs)("div",{className:"md:col-span-2 space-y-2",children:[(0,s.jsx)(d.J,{htmlFor:"images",children:g("newProperty.form.photos")}),(0,s.jsx)(l.p,{id:"images",type:"file",multiple:!0,accept:"image/*",onChange:e=>{if(e.target.files){let r=Array.from(e.target.files);R(r),B.forEach(e=>URL.revokeObjectURL(e)),A(r.map(e=>URL.createObjectURL(e)))}}}),B.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2 mt-2",children:B.map((e,r)=>(0,s.jsx)("div",{className:"relative aspect-square",children:(0,s.jsx)(x.default,{src:e,alt:`Preview ${r+1}`,fill:!0,className:"rounded-md object-cover"})},r))})]})]}),(0,s.jsx)(n.wL,{children:(0,s.jsxs)(i.$,{type:"submit",size:"lg",disabled:P,children:[P&&(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),g("newProperty.form.submit")]})})]})})})}},90298:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>c,pages:()=>p,routeModule:()=>u,tree:()=>d});var s=t(65239),a=t(48088),o=t(88170),i=t.n(o),n=t(30893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);t.d(r,l);let d={children:["",{children:["(main)",{children:["properties",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,44386)),"/home/user/studio/src/app/(main)/properties/new/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,60448)),"/home/user/studio/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,p=["/home/user/studio/src/app/(main)/properties/new/page.tsx"],c={require:t,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(main)/properties/new/page",pathname:"/properties/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[447,919,439,355,684,871],()=>t(90298));module.exports=s})();